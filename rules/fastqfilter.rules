from Bio import SeqIO
from numpy import mean
import os

rule run_fastqfilter:
    """
    Filter by average quality score
    """
    input:
        "QC/{dir}/pandaseq.fq"
    output:
        "QC/{dir}/high_quality.fq"
    params:
        qmin = QUA_MIN,
        job_name = "FaFi",
        cluster = "-cwd -l vf=1G -e logs/ -o logs/"
    shell:
        ENV_BIN + "python " + SCRIPTS_BIN + "fastqfilter.py"
         " -i {input}"
         " -o {output}"
         " -q {params.qmin}"